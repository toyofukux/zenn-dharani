---
title: "Shifter Headlessã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ‹¡å¼µã™ã‚‹"
emoji: "ğŸ“‘"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Wordpress", "Shifter"]
published: true
---

[Beyond Magazine](https://beyondmag.jp?utm_source=zenn) ã§ã¯ Shifter Headless ã‚’ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç’°å¢ƒã§ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚  
[(Shifter Static ã¨ Headless ã®é•ã„ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰)](https://www.getshifter.io/ja/explaining-the-difference-between-shifter-static-and-shifter-headless-ja/)
ä»Šå›ã¯ Shifter Headless ã‚’å°å…¥ã—ãŸéš›ã«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«é ¼ã‚‰ãšã«ã©ã†ã‚„ã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹ã‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ãªãœãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ‹¡å¼µã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹

Beyond Magazine ã®å¼·ã¿ã¨ã—ã¦ã€
**å„ç•Œä¸€æµã®è­˜è€…ã‚„ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼ãŸã¡ãŒåŸ·ç­†ã™ã‚‹ãƒ¡ãƒ‡ã‚£ã‚¢ã§ã‚ã‚‹**
ã¨ã„ã†ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚
ãã®ãŸã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã ã‘ã§ã¯ãªãã€åŸ·ç­†è€…ã®æ–¹ãŸã¡ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å……å®Ÿã•ã›ã¦é­…åŠ›çš„ã«è¦‹ã›ã‚‹ã“ã¨ã‚‚é‡è¦ã§ã™ã€‚
Wordpress ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ã‚Œã°æ°åã‚„è‡ªå·±ç´¹ä»‹ãªã©ã®é …ç›®ã—ã‹åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€å„ SNS ã‚„å€‹äººã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚‚åŸ·ç­†è€…ã«ã¨ã£ã¦é‡è¦ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã§ã™ã€‚
ãªã®ã§ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã«ã‚ˆã‚Šã“ã‚Œã‚‰ã®é …ç›®ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
é€šå¸¸ã® Wordpress ã§ã‚ã‚Œã°ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å…¥ã‚Œã‚‹ã“ã¨ã«ã‚ˆã£ã¦æ‹¡å¼µãŒå¯èƒ½ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€[ä»¥å‰ã®è¨˜äº‹](https://zenn.dev/takasing/articles/first-custom-block)ã§ç´¹ä»‹ã—ãŸã‚ˆã†ã«ã€ Shifter Headless ã§ã¯ plugin ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒã§ãã¾ã›ã‚“ã€‚
ãªã®ã§ä»Šå›ã‚‚[Code Snippets](https://ja.wordpress.org/plugins/code-snippets/)ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’æ‹¡å¼µã—ã¦ã„ãã¾ã™ã€‚

## ã‚„ã‚‹ã“ã¨

Wordpress ã‚’ Headless CMS ã¨ã—ã¦åˆ©ç”¨ã—ã€GraphQL çµŒç”±ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã«ã¯ä»¥ä¸‹ã® 2 ã¤ã®ä½œæ¥­ãŒå¿…è¦ã§ã™ã€‚

1. Wordpress ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ›ãƒšãƒ¼ã‚¸ã«æ‹¡å¼µã—ãŸã„é …ç›®ã®å…¥åŠ›æ¬„ã‚’è¨­ã‘ã‚‹
   1. ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ ã™ã‚‹
   1. ä¿å­˜ã—ãŸéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹
1. WPGraphQL ã®ã‚¹ã‚­ãƒ¼ãƒã‚’æ‹¡å¼µã™ã‚‹

ã“ã‚Œã‚‰ã‚’ Code Snippets ã‚’åˆ©ç”¨ã—ã¦è¡Œã„ã¾ã™ã€‚

ãªãŠã€å®Œæˆå½¢ã¯[ã“ã®ãƒªãƒã‚¸ãƒˆãƒª](https://github.com/takasing/wordpress-extend-graphql-schema)ã«ä¸Šã’ã¦ã„ã‚‹ã®ã§ã€Import ã—ã¦ä½¿ã£ã¦ãã ã•ã„ã€‚

## ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ›ãƒšãƒ¼ã‚¸ã«æ‹¡å¼µã—ãŸã„é …ç›®ã®å…¥åŠ›æ¬„ã‚’è¨­ã‘ã‚‹

ã“ã“ã‹ã‚‰ã¯ã‚·ãƒ³ãƒ—ãƒ«ã« snippets ã‚’è¨˜è¼‰ã—ã¦ã„ãã¾ã™ã€‚
ã¾ãšã¯ãƒ•ã‚©ãƒ¼ãƒ è‡ªä½“ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```php:expand_profile_v1
function append_custom_fields ($user) {
	?>
	<table id="custom_user_field_table" class="form-table">
        <tr id="custom_user_field_row">
            <th>
                <label for="twitter">Twitter</label>
            </th>
            <td>
                <input type="text" name="twitter" id="twitter" value="<?php echo esc_attr( get_the_author_meta( 'twitter', $user->ID ) ); ?>" class="regular-text" /><br />
                <span class="description">@ä»¥ä¸‹ã‚’å…¥åŠ›</span>
            </td>
        </tr>
    </table>
<?php
}
add_action( 'show_user_profile', 'append_custom_fields' );
add_action( 'edit_user_profile', 'append_custom_fields' );
```

ã“ã‚Œã‚’ä¿å­˜ã—ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã«è¡Œãã¨ã€ä¸‹ã®æ–¹ã«å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚

![ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å…¥åŠ›æ¬„ã‚’è¿½åŠ ](https://storage.googleapis.com/zenn-user-upload/a49bd714605ac42939b6d51f.png)

ã—ã‹ã—ã€ã“ã®ã¾ã¾ã ã¨ä¿å­˜ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã¯ä¿å­˜ã•ã‚Œãªã„ã®ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹è¨˜è¿°ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```php:expand_profile_v2
function append_custom_fields ($user) {
	?>
	<table id="custom_user_field_table" class="form-table">
        <tr id="custom_user_field_row">
            <th>
                <label for="twitter">Twitter</label>
            </th>
            <td>
                <input type="text" name="twitter" id="twitter" value="<?php echo esc_attr( get_the_author_meta( 'twitter', $user->ID ) ); ?>" class="regular-text" /><br />
                <span class="description">@ä»¥ä¸‹ã‚’å…¥åŠ›</span>
            </td>
        </tr>
    </table>
<?php
}
add_action( 'show_user_profile', 'append_custom_fields' );
add_action( 'edit_user_profile', 'append_custom_fields' );
function edit_additional_profile ($user_id) {
	if ( isset( $_POST['twitter'] ) ) {
        update_user_meta($user_id, 'twitter', $_POST['twitter']);
    }
}
add_action('profile_update', 'edit_additional_profile');
```

ã“ã‚Œã§ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã«è¿½åŠ ã—ãŸãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒ Wordpress ã«ä¿å­˜ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## WPGraphQL ã®ã‚¹ã‚­ãƒ¼ãƒã‚’æ‹¡å¼µã™ã‚‹

Wordpress ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯ä¿å­˜ã•ã‚Œã¾ã—ãŸãŒã€ã“ã®ã¾ã¾ã§ã¯ã¾ã  WPGraphQL ã®ã‚¹ã‚­ãƒ¼ãƒã« Twitter ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç”¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã®ã§æ‹¡å¼µã—ã¾ã™ã€‚

```php:expand_gq
function add_custom_fields() {
  register_graphql_field('user', 'twitter', [
    'type' => 'String',
    'args' => [],
    'resolve' => function ($source) {
		$fields = get_user_meta($source->userId, 'twitter', true);
		if ( isset( $fields ) ) {
      		return $fields;
   		}
    	return null;
	}
  ]);
}

add_action( 'graphql_register_types', 'add_custom_fields');
```

![GraphiQLã®å®Ÿè¡Œçµæœ](https://storage.googleapis.com/zenn-user-upload/8ec574602db01000ecdaa624.png)

## ã¾ã¨ã‚

Wordpress ã‚’æ‹¡å¼µã™ã‚‹éš›ã¯ã€ã€Œ`add_action`ãªã©ã‚’ç”¨ã„ã¦ç‰¹å®šã®å‡¦ç†ã« hook ã—ã¦å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã€ã¨ã„ã†ã®ã‚’è¦šãˆã¦ãŠãã¨ç†è§£ã—ã‚„ã™ã„ã§ã™ã€‚
å¾Œã¯å°‘ã—ã® php ã‚’(è¡€ã®æ¶™ã‚’æµã—ãªãŒã‚‰)æ›¸ãã ã‘ã§ã™ã€‚
Action ã«é–¢ã—ã¦ã¯ [Wordpress ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® hooks](https://developer.wordpress.org/reference/hooks/)ã‚’å‚ç…§ã™ã‚‹ã¨ã€ã©ã†ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆã«å¼•ã£æ›ã‘ãŸã„ã‹ã‚’æ±ºã‚ã‚„ã™ã„ã§ã™ã€‚
Plugin ã«ã¤ã„ã¦ã‚‚åŒæ§˜ã§ã€Plugin ãŒè¿½åŠ ã—ãŸ Hook ãŒã‚ã‚‹ã®ã§ã€ãã“ã«å‡¦ç†ã‚’ hook ã•ã›ã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ã€‚

[Beyond Magazine](https://beyondmag.jp?utm_source=zenn) ã§ã¯é–‹ç™ºãƒ¡ãƒ³ãƒãƒ¼ã‚’å‹Ÿé›†ã—ã¦ã„ã‚‹ã®ã§ã”èˆˆå‘³ã‚ã‚‹æ–¹ã¯ Twitter ã® DM ä¸‹ã•ã„ï¼
![](https://storage.googleapis.com/zenn-user-upload/umo6g8r6dcoj4pz2poy8srgbq8xn)

## å‚è€ƒ

- [Extending WPGraphQL for Custom Meta Boxes with React and Apollo in a WordPress Theme Tutorial](https://javascriptforwp.com/extending-wpgraphql-for-custom-meta-boxes-with-react-and-apollo-in-a-wordpress-theme-tutorial/)
- [WPGraphQL - register_graphql_field](https://www.wpgraphql.com/functions/register_graphql_field/)
- [Registering GraphQL Fields with Arguments](https://www.wpgraphql.com/2020/03/11/registering-graphql-fields-with-arguments/)
- [How to add custom fields to the schema?](https://github.com/wp-graphql/wp-graphql/issues/1097)
- [User Profile / Add Custom Fields](https://wordpress.stackexchange.com/questions/39285/user-profile-add-custom-fields)
